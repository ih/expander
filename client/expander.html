<template name="expander">
	<div id="expander-{{_id}}" class="expander">
		{{#if editMode}}
		<h3><input type="text" class="title-input" value="{{title}}"></h3>
		{{else}}
		<a href="/expanders/{{_id}}"><h3>{{title}}</h3></a>
		{{/if}}
		{{#unless currentExpander}}
		<button class="unexpand">close</button>
		{{/unless}}
		{{#if fromExpanderIds}}
		{{#each fromExpanderIds}}
		<!--replace with getFragmentContent helper -->
		<div>linked from: <a href="/expanders/{{this}}">{{getTitle this}}</a></div>
		{{/each}}
		{{/if}}
		<button class="highlight-all-fragments">
			Highlight All Fragments
		</button>
		<button class="clear-all-highlights">
			Clear All Highlights
		</button>
		<button class="highlight-selected">
			Highlight Selected Fragments
		</button>

		<div class="edit-mode {{show editMode}}">
			<pre>{{{renderContent}}}</pre>
		</div>
		<div class="view-mode {{hide editMode}}">
			<button class="edit {{hide editMode}}">Edit</button>
			<div class="content">
				<!-- important to have the pre tags wrapped tightly around the content b/c
					whitespace will get displayed-->
				<pre>{{{renderContent}}}</pre>
			</div>
			<div>
				{{> fragmentsViewer this}}
			</div>
		</div>
	</div>
</template>
