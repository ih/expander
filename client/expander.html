<template name="expander">
	<div id="expander-{{_id}}" class="expander">
		{{#if editMode}}
		<h3><input type="text" class="title-input" value="{{title}}"></h3>
		{{else}}
		<h3>{{title}}</h3>
		{{/if}}

		{{#if parent}}
		<div>parent: <a href="/expanders/{{parent}}">{{getParentFragment _id}}</a></div>
		{{/if}}
		<button class="highlight-all-fragments">
			Highlight All Fragments
		</button>
		<button class="clear-all-highlights">
			Clear All Highlights
		</button>
		<button class="highlight-selected">
			Highlight Selected Fragments
		</button>

		<div class="edit-mode {{show editMode}}">
			<pre>{{{renderContent}}}</pre>
		</div>
		<div class="view-mode {{hide editMode}}">
			<button class="edit {{hide editMode}}">Edit</button>
			<div class="content">
				<!-- important to have the pre tags wrapped tightly around the content b/c
					whitespace will get displayed-->
				<pre>{{content}}</pre>
			</div>
			<div>
				<ul>
					{{#each fragments}}
					<li><a href="/expanders/{{id}}">{{getParentFragment id}}</a></li>
					{{/each}}
				</ul>
			</div>
			<div>
				{{> fragmentsViewer this}}
			</div>
			<div>
				<!--these get positioned absolutely where they appear within the 
						expander-->
				{{#each fragments}}
				{{> fragment this}}
				{{/each}}
			</div>
		</div>
	</div>
</template>
