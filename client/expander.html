<template name="expander">
	<div class="expander">
		{{#if editMode}}
		<h3><input type="text" class="title-input" value="{{title}}"></h3>
		{{else}}
		<h3>{{title}}</h3>
		{{/if}}

		{{#if parent}}
		<div>parent: <a href="/expanders/{{parent}}">{{getTitle parent}}</a></div>
		{{/if}}
		<button class="highlight-all-fragments">
			Highlight All Fragments
		</button>
		<button class="clear-all-highlights">
			Clear All Highlights
		</button>
		<button class="highlight-selected">
			Highlight Selected Fragments
		</button>

		<!--TODO make edit/view-mode separate templates?-->
		<div class="edit-mode {{show editMode}}">
			<button class="save">Save</button>
			<button class="cancel">Cancel</button>
			<textarea class="plain content-input">{{content}}</textarea>
		</div>
		<div class="view-mode {{hide editMode}}">
			<button class="edit {{hide editMode}}">Edit</button>
			<div class="content rendered  {{hide selectMode}}">
				<!-- important to have the pre tags wrapped tightly around the content b/c
					whitespace will get displayed-->
				<pre>{{{renderContent}}}</pre>
			</div>
			<div class="content plain {{show selectMode}}">
				<!-- important to have the pre tags wrapped tightly around the content b/c
					whitespace will get displayed-->
				<pre>{{content}}</pre>
			</div>
			<div>
				<ul>
					{{#each fragments}}
					<li><a href="/expanders/{{id}}">{{getTitle id}}</a></li>
					{{/each}}
				</ul>
			</div>
			<div>
				{{> fragmentsViewer this}}
			</div>
		</div>
	</div>
</template>
